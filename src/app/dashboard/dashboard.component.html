<div class="dashboard-container">
  <header class="dashboard-header">
    <div class="header-content">
      <h1>Jira Task Management</h1>
      <div class="user-info" *ngIf="currentUser">
        <img [src]="currentUser.avatarUrls['24x24']" [alt]="currentUser.displayName" class="avatar">
        <span>{{ currentUser.displayName }}</span>
        <button class="logout-btn" (click)="logout()">Logout</button>
      </div>
    </div>
  </header>

  <main class="dashboard-main">
    <nav class="tab-navigation">
      <button 
        class="tab-btn" 
        [class.active]="selectedTab === 'assigned'"
        (click)="selectTab('assigned')">
        My Assigned Issues ({{ assignedIssues.length }})
      </button>
      <button 
        class="tab-btn" 
        [class.active]="selectedTab === 'reported'"
        (click)="selectTab('reported')">
        My Reported Issues ({{ reportedIssues.length }})
      </button>
      <button 
        class="tab-btn" 
        [class.active]="selectedTab === 'projects'"
        (click)="selectTab('projects')">
        Projects ({{ projects.length }})
      </button>
    </nav>

    <!-- Assigned Issues Tab -->
    <div class="tab-content" *ngIf="selectedTab === 'assigned'">
      <div class="section-header">
        <h2>Issues Assigned to Me</h2>
        <button class="refresh-btn" (click)="loadAssignedIssues()" [disabled]="isLoadingAssigned">
          {{ isLoadingAssigned ? 'Loading...' : 'Refresh' }}
        </button>
      </div>

      <div class="loading" *ngIf="isLoadingAssigned">Loading assigned issues...</div>
      <div class="error" *ngIf="assignedError">{{ assignedError }}</div>

      <div class="issues-grid" *ngIf="!isLoadingAssigned && !assignedError">
        <div class="issue-card" *ngFor="let issue of assignedIssues">
          <div class="issue-header">
            <span class="issue-key">{{ issue.key }}</span>
            <span class="issue-priority">{{ getPriorityIcon(issue.fields.priority.name) }}</span>
          </div>
          <h3 class="issue-title">{{ issue.fields.summary }}</h3>
          <div class="issue-meta">
            <span class="issue-type">{{ issue.fields.issuetype.name }}</span>
            <span class="issue-project">{{ issue.fields.project.name }}</span>
          </div>
          <div class="issue-status" [style.background-color]="getStatusColor(issue.fields.status.statusCategory.key)">
            {{ issue.fields.status.name }}
          </div>
          <div class="issue-dates">
            <small>Updated: {{ formatDate(issue.fields.updated) }}</small>
          </div>
        </div>
      </div>

      <div class="empty-state" *ngIf="!isLoadingAssigned && !assignedError && assignedIssues.length === 0">
        <p>No issues assigned to you</p>
      </div>
    </div>

    <!-- Reported Issues Tab -->
    <div class="tab-content" *ngIf="selectedTab === 'reported'">
      <div class="section-header">
        <h2>Issues Reported by Me</h2>
        <button class="refresh-btn" (click)="loadReportedIssues()" [disabled]="isLoadingReported">
          {{ isLoadingReported ? 'Loading...' : 'Refresh' }}
        </button>
      </div>

      <div class="loading" *ngIf="isLoadingReported">Loading reported issues...</div>
      <div class="error" *ngIf="reportedError">{{ reportedError }}</div>

      <div class="issues-grid" *ngIf="!isLoadingReported && !reportedError">
        <div class="issue-card" *ngFor="let issue of reportedIssues">
          <div class="issue-header">
            <span class="issue-key">{{ issue.key }}</span>
            <span class="issue-priority">{{ getPriorityIcon(issue.fields.priority.name) }}</span>
          </div>
          <h3 class="issue-title">{{ issue.fields.summary }}</h3>
          <div class="issue-meta">
            <span class="issue-type">{{ issue.fields.issuetype.name }}</span>
            <span class="issue-project">{{ issue.fields.project.name }}</span>
          </div>
          <div class="issue-assignee" *ngIf="issue.fields.assignee">
            Assigned to: {{ issue.fields.assignee.displayName }}
          </div>
          <div class="issue-status" [style.background-color]="getStatusColor(issue.fields.status.statusCategory.key)">
            {{ issue.fields.status.name }}
          </div>
          <div class="issue-dates">
            <small>Updated: {{ formatDate(issue.fields.updated) }}</small>
          </div>
        </div>
      </div>

      <div class="empty-state" *ngIf="!isLoadingReported && !reportedError && reportedIssues.length === 0">
        <p>No issues reported by you</p>
      </div>
    </div>

    <!-- Projects Tab -->
    <div class="tab-content" *ngIf="selectedTab === 'projects'">
      <div class="section-header">
        <h2>Projects</h2>
        <button class="refresh-btn" (click)="loadProjects()" [disabled]="isLoadingProjects">
          {{ isLoadingProjects ? 'Loading...' : 'Refresh' }}
        </button>
      </div>

      <div class="loading" *ngIf="isLoadingProjects">Loading projects...</div>
      <div class="error" *ngIf="projectsError">{{ projectsError }}</div>

      <div class="projects-grid" *ngIf="!isLoadingProjects && !projectsError">
        <div class="project-card" *ngFor="let project of projects">
          <div class="project-header">
            <span class="project-key">{{ project.key }}</span>
            <span class="project-type">{{ project.projectTypeKey }}</span>
          </div>
          <h3 class="project-name">{{ project.name }}</h3>
          <div class="project-meta">
            <span class="project-style" [class.simplified]="project.simplified">
              {{ project.simplified ? 'Team-managed' : 'Company-managed' }}
            </span>
          </div>
        </div>
      </div>

      <div class="empty-state" *ngIf="!isLoadingProjects && !projectsError && projects.length === 0">
        <p>No projects available</p>
      </div>
    </div>
  </main>
</div>